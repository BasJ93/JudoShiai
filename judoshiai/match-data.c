/* -*- mode: C; c-basic-offset: 4;  -*- */

/*
 * Copyright (C) 2006-2010 by Hannu Jokinen
 * Full copyright text is included in the software package.
 */ 

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <gtk/gtk.h>

#include <cairo.h>
#include <cairo-pdf.h>

#include "judoshiai.h"

const guint pools[8][11][2] = {
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 0 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 1 */
#ifdef ONE_MATCH
    {{1, 2}, {0,0}}, /* 2 */
#else
    {{1, 2}, {1, 2}, {1, 2}, {0,0}}, /* 2 */
#endif
    {{1, 2}, {1, 3}, {2, 3}, {0,0}}, /* 3 */
    {{1, 2}, {3, 4}, {1, 3}, {2, 4}, {1, 4}, {2, 3}, {0,0}}, /* 4 */
    {{4, 5}, {1, 2}, {3, 4}, {1, 5}, {2, 3}, {1, 4}, {3, 5}, {2, 4}, {1, 3}, {2, 5}, {0,0}}, /* 5 */
    {{1, 2}, {4, 5}, {1, 3}, {4, 6}, {2, 3}, {5, 6}, {0,0}}, /* 6 */
    {{1, 2}, {3, 4}, {5, 6}, {1, 3}, {2, 4}, {5, 7}, {1, 4}, {2, 3}, {6, 7}, {0,0}} /* 7 */
};

const guint french_num_matches[NUM_TABLES][NUM_FRENCH] = {
    {11, 23, 43, 79}, // double repechage
    {11, 23, 43, 79}, // dubbelt aaterkval
    {11, 27, 59, 79}, // direct aaterkval
    {11, 27, 59, 123}, // est klass d
    { 7, 15, 31, 63}, // no repechage
    {11, 19, 37, 71}  // enkelt aaterkval
};

const gint medal_matches[NUM_TABLES][NUM_FRENCH][3] = {
    {{9,10,11}, {21,22,23}, {41,42,43}, {77,78,79}},    // double repechage
    {{9,10,11}, {21,22,23}, {41,42,43}, {77,78,79}},    // dubbelt aaterkval
    {{9,10,11}, {25,26,27}, {57,58,59}, {77,78,79}},    // direkt aaterval
    {{9,10,11}, {25,26,27}, {57,58,59}, {121,122,123}}, // estonian D klass
    {{5,6,7},   {13,14,15}, {29,30,31}, {61,62,63}},    // no repechage
    {{9,10,11}, {17,18,19}, {35,36,37}, {69,70,71}}     // enkelt aaterkval
};	

const gchar french_64_matches_to_page[NUM_TABLES][NUM_MATCHES] = {
{ // double repechage
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 9 // don't draw match 79
},{ // dubbelt aaterkval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 2, 2, 0, 1, 2, 2, 9 // don't draw match 79
},{ // direkt aaterval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 9 // don't draw match 79
},{ // estonian D klass
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
    /*  51,52,53,54,55,56,57,58,59,60 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 1, 1, 1, 1, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 0, 0, 1, 1, 2, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 0, 1, 2, 2,
    /*  121,122,123 */
    2, 2, 2
},{ // no repechage
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  91,92,93,94,95,96,97,98,99,100 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  101,102,103,104,105,106,107,108,109,110 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  111,112,113,114,115,116,117,118,119,120 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  121,122,123 */
    0, 0, 0
},{ // enkelt aaterkval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2
}};

const gint result_y_position[NUM_TABLES][NUM_FRENCH] = {
    {4, 12, 28, 0},
    {4, 12, 28, 0},
    {4, 16, 44, 0},
    {4, 12, 44, 0},
    {0, 0, 0, 0},
    {4, 12, 30, 0}
};

const gint repechage_start[NUM_TABLES][NUM_FRENCH][2] = {
    {{7,0}, {0,0},   {29,0},  {0,63}},  // double repechage
    {{7,0}, {0,0},   {29,0},  {0,63}},  // dubbelt aaterkval
    {{7,0}, {0,0},   {17,0},  {0,63}}, // direkt aaterval
    {{7,0}, {0,0},   {0,0},   {0,0}}, // estonian D klass
    {{0,0}, {0,0},   {0,0},   {0,0}},   // no repechage
    {{7,0}, {15,16}, {31,32}, {0,64}}  // enkelt aaterkval
};

const gint french_matches[NUM_TABLES][NUM_FRENCH][NUM_MATCHES][2] = {
    /* Double repechage */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 9,10},{11,12},{13,14},{15,16},
	    /*  21,     22,     23 */
	    {19,-18},{20,-17},{17,18}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{25,26},{27,28},{33,34},{35,36},
	    /*  41,     42,     43 */
	    {39,-38},{40,-37},{37,38}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{57,58},{59,60},{69,70},{71,72},{75,-74},{76,-73},{73,74}
	}
    },
    /* Swedish Dubbelt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 13,14},{15,16},{9,10},{11,12},
	    /*  21,     22,     23 */
	    {17,-20},{18,-19},{19,20}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{33,34},{35,36},{25,26},{27,28},
	    /*  41,     42,     43 */
	    {37,-40},{38,-39},{39,40}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{69,70},{71,72},{57,58},{59,60},{73,-76},{74,-75},{75,76}
	}
    },
    /* Swedish Direkt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    {-5,-6},{-7,-8},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,-14},{10,-13},{11,-16},{12,-15},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    {13,14},{15,16},{17,18},{19,20},{23,-22},{24,-21},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{-5,-6},{-7,-8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    {-9,-10},{-11,-12},{-13,-14},{-15,-16},{1,2},{3,4},{5,6},{ 7, 8},{ 9,10},{11,12},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {13,14},{15,16},{17,-26},{18,-25},{19,-28},{20,-27},{21,-30},{22,-29},{23,-32},{24,-31},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {25,26},{27,28},{29,30},{31,32},{33,34},{35,36},{37,38},{39,40},{41,42},{43,44},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {45,-42},{46,-41},{47,-44},{48,-43},{51,52},{53,54},{55,-50},{56,-49},{49,50}
	},
	/* <= 64 competitors (Dubbelt aaterkval)*/
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51, 52, 53, 54, 55, 56, 57, 58, 59, 60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{69,70},{71,72},{57,58},{59,60},{73,-76},{74,-75},{75,76}
	}
    },
    /* Estonian for D klass */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{-1,-2},{-3,-4},{-5,-6},{-7,-8},{13,-10},{14,-9},{15,-12},{16,-11},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    { 9,10},{11,12},{17,18},{19,20},{23,-22},{24,-21},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{-5,-6},{-7,-8},{-1,-2},{-3,-4},{-13,-14},{-15,-16},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {-9,-10},{-11,-12},{25,-17},{26,-18},{27,-19},{28,-20},{29,-21},{30,-22},{31,-23},{32,-24},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{33,34},{35,36},{37,38},{39,40},{45,-42},{46,-41},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {47,-44},{48,-43},{41,42},{43,44},{49,50},{51,52},{55,-54},{56,-53},{53,54}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9,10},  {11,12},  {13,14},  {15,16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {17,18},   {19,20},   {21,22},   {23,24},   {25,26},   {27,28},   {29,30},  {31,32},  {-1,-2},  {-3,-4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {-5,-6},   {-7,-8},   {-9,-10},  {-11,-12}, {-13,-14}, {-15,-16}, {-17,-18},{-19,-20},{-21,-22},{-23,-24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    {-25,-26}, {-27,-28}, {-29,-30}, {-31,-32}, {49,-35},  {50,-36},  {51,-33}, {52,-34}, {53,-39}, {54,-40},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {55,-37},  {56,-38},  {57,-43},  {58,-44},  {59,-41},  {60,-42},  {61,-47}, {62,-48}, {63,-45}, {64,-46},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {33,34},   {35,36},   {37,38},   {39,40},   {41,42},   {43,44},   {45,46},  {47,48},  {65,66},  {67,68},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {69,70},   {71,72},   {73,74},   {75,76},   {77,78},   {79,80},   {89,-83}, {90,-84}, {91,-81}, {92,-82},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {93,-87},  {94,-88},  {95,-85},  {96,-86},  {81,82},   {83,84},   {85,86},  {87,88},  {97,98},  {99,100},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {101,102}, {103,104}, {109,-105},{110,-106},{111,-107},{112,-108},{105,106},{107,108},{113,114},{115,116},
	    /* 121,       122,       123      */
	    {119,-118},{120,-117},{117,118}
	}
    },
    /* No repechage */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    {57,58},{59,60},{61,62}
	}
    },
    /* Swedish Enkelt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{ 0, 0},{ 0, 0},{ 15,-13},{16,-14},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{31, 0},{32, 0},{33,-29},{34,-30},{29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    {57,58},{59,60},{ 0, 0},{ 0, 0},{63, 0},{64, 0},{65, 0},{66, 0},{67,-62},{68,-61},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {61,62}
	}
    }
};

static const gint system_menu_order[NUM_SYSTEMS] = {
    CAT_SYSTEM_DEFAULT,
    CAT_SYSTEM_POOL,
    CAT_SYSTEM_DPOOL,
    CAT_SYSTEM_REPECHAGE,
    CAT_SYSTEM_ENKELT_AATERKVAL,
    CAT_SYSTEM_DUBBELT_AATERKVAL,
    CAT_SYSTEM_DIREKT_AATERKVAL,
    CAT_SYSTEM_EST_D_KLASS,
    CAT_SYSTEM_NO_REPECHAGE
};

// Return name of the system
static gchar *get_system_name(gint num)
{
    switch (num) {
    case CAT_SYSTEM_DEFAULT: return _("Default");
    case CAT_SYSTEM_POOL: return _("Round Robin");
    case CAT_SYSTEM_DPOOL: return _("Double Round Robin");
    case CAT_SYSTEM_REPECHAGE: return _("Double Repechage");
    case CAT_SYSTEM_DUBBELT_AATERKVAL: return _("SWE Double Repechage");
    case CAT_SYSTEM_DIREKT_AATERKVAL: return _("SWE Double Elimination");
    case CAT_SYSTEM_EST_D_KLASS: return _("EST Double Elimination");
    case CAT_SYSTEM_NO_REPECHAGE: return _("Single Elimination");
    case CAT_SYSTEM_ENKELT_AATERKVAL: return _("SWE Single Repechage");
    }
}

gchar *get_system_name_for_menu(gint num)
{
    return get_system_name(system_menu_order[num]);
}

gint get_system_number_by_menu_pos(gint num)
{
    return system_menu_order[num];
}

gint get_system_menu_selection(gint active)
{
    gint i;
    for (i = 0; i < NUM_SYSTEMS; i++)
	if (active == system_menu_order[i])
	    return i;

    return 0;
}
